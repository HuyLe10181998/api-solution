{"version":3,"file":"_page.svelte-bCNEzFeU.js","sources":["../../../.svelte-kit/adapter-node/entries/pages/(admin)/admin/blog/_page.svelte.js"],"sourcesContent":["import { Q as store_get, P as escape_html, R as unsubscribe_stores, W as bind_props, O as pop, K as push, T as ensure_array_like } from \"../../../../../chunks/index.js\";\nimport { g as goto } from \"../../../../../chunks/client.js\";\nimport { p as page } from \"../../../../../chunks/stores.js\";\nimport { a as appApi } from \"../../../../../chunks/app.api.js\";\nimport { p as pathAdmin } from \"../../../../../chunks/path.admin.js\";\nimport { M as Modal } from \"../../../../../chunks/Modal.js\";\nimport { f as fallback } from \"../../../../../chunks/utils.js\";\nimport { w as writable } from \"../../../../../chunks/index3.js\";\nimport { a as addToast } from \"../../../../../chunks/notification.js\";\nimport dayjs from \"dayjs\";\nimport { a as attr } from \"../../../../../chunks/attributes.js\";\nimport { P as Pagination } from \"../../../../../chunks/Pagination.js\";\nimport { g as globalLoading } from \"../../../../../chunks/store.js\";\nfunction Card($$payload, $$props) {\n  push();\n  var $$store_subs;\n  let fetchData = fallback($$props[\"fetchData\"], () => {\n  });\n  let blog = $$props[\"blog\"];\n  let isModalOpen = writable(false);\n  const closeModal = () => isModalOpen.set(false);\n  const handleDelete = async (id) => {\n    const response = await appApi.deleteBlog(id);\n    if (\"error\" in response) {\n      addToast({ message: response.error, type: \"error\" });\n      return;\n    }\n    fetchData();\n    addToast({\n      message: \"Blog deleted successfully\",\n      type: \"success\"\n    });\n  };\n  Modal($$payload, {\n    action: () => {\n      handleDelete(blog.id);\n    },\n    isOpen: store_get($$store_subs ??= {}, \"$isModalOpen\", isModalOpen),\n    closeModal,\n    children: ($$payload2) => {\n      $$payload2.out += `<h2 class=\"text-xl font-semibold\">Confirm Delete</h2> <p>Are you sure you want to delete this blog ?</p>`;\n    },\n    $$slots: { default: true }\n  });\n  $$payload.out += `<!----> <div class=\"single-blog-post max-w-[500px]\"><div class=\"post-content\"><div class=\"flex gap-4\"><span><i class=\"fal fa-comments mr-2\"></i>${escape_html(blog.author)}</span> <span><i class=\"fal fa-calendar-alt mr-2\"></i>${escape_html(dayjs(blog.date).format(\"DD MMMM YYYY\"))}</span></div> <h2 class=\"text-xl\"><a${attr(\"href\", pathAdmin.blog.edit(String(blog.id)))}>${escape_html(blog.title)}</a></h2> <p>${escape_html(blog.description)}</p> <div class=\"flex gap-2\"><a${attr(\"href\", pathAdmin.blog.edit(String(blog.id)))} class=\"theme-btn !bg-blue-500 !rounded-lg px-4 py-2 mt-4 line-height\"><span>Edit</span></a> <button class=\"theme-btn !rounded-lg px-4 py-2 mt-4 line-height\"><span>Delete</span></button></div></div></div>`;\n  if ($$store_subs) unsubscribe_stores($$store_subs);\n  bind_props($$props, { fetchData, blog });\n  pop();\n}\nfunction useDebounce(value, delay) {\n  const debouncedValue = writable(value);\n  return debouncedValue;\n}\nfunction _page($$payload, $$props) {\n  push();\n  var $$store_subs;\n  const urlParams = new URLSearchParams(store_get($$store_subs ??= {}, \"$page\", page).url.search);\n  urlParams.get(\"limit\");\n  let blogs = writable([]);\n  let totalPages = writable(0);\n  let totalBlogs = writable(0);\n  let isLoading = writable(true);\n  let search = \"\";\n  const debouncedSearchInput = useDebounce(search);\n  debouncedSearchInput.subscribe((value) => {\n    console.log(\"debouncedSearchInput value changed\", value);\n  });\n  const fetchBlogs = async ({ page: page2, limit, search: search2 }) => {\n    globalLoading.set(true);\n    isLoading.set(true);\n    try {\n      console.log(\"search\", search2);\n      const data = await appApi.getBlogs({ page: page2, limit, search: search2 });\n      totalPages.set(data.totalPages);\n      totalBlogs.set(data.totalBlogs);\n      blogs.set(data.blogs);\n    } catch (e) {\n      console.log(e);\n    } finally {\n      globalLoading.set(false);\n      isLoading.set(false);\n    }\n  };\n  const handlePageChange = async (page2) => {\n    await goto();\n  };\n  const each_array = ensure_array_like(store_get($$store_subs ??= {}, \"$blogs\", blogs));\n  $$payload.out += `<div class=\"p-8\"><div class=\"flex gap-4 mb-8 justify-center\"><h1 class=\"!text-4xl text-center\">Blog List</h1></div> <div class=\"flex gap-2 max-w-[600px] mx-auto mb-8\"><input${attr(\"value\", search)} type=\"text\" class=\"flex-1 rounded-md p-2 svelte-1n2sg7j\" placeholder=\"Search...\"> <button class=\"bg-blue-500 min-w-[120px] hover:bg-indigo-700 text-white font-bold py-2 px-4 rounded\"><a class=\"text-neutral-50\"${attr(\"href\", pathAdmin.blog.create())}>Add blog +</a></button></div> <div class=\"flex flex-wrap gap-8\"><!--[-->`;\n  for (let $$index = 0, $$length = each_array.length; $$index < $$length; $$index++) {\n    let blog = each_array[$$index];\n    Card($$payload, {\n      fetchData: () => {\n        fetchBlogs({\n          page: 1,\n          limit: 10,\n          search: store_get($$store_subs ??= {}, \"$debouncedSearchInput\", debouncedSearchInput)\n        });\n      },\n      blog\n    });\n  }\n  $$payload.out += `<!--]--></div> `;\n  Pagination($$payload, {\n    totalPages: store_get($$store_subs ??= {}, \"$totalPages\", totalPages),\n    onPageChange: handlePageChange\n  });\n  $$payload.out += `<!----></div>`;\n  if ($$store_subs) unsubscribe_stores($$store_subs);\n  pop();\n}\nexport {\n  _page as default\n};\n"],"names":[],"mappings":"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"}